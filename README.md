# Live Looper App for Sonic Pi

## Introduction

This is an application to capture live sound loops with Sonic Pi and control the recording and playback with a [touchosc](https://hexler.net/docs/touchosc) interface. The sound is captured from the soundcard input with the `live_audio`-functionality of Sonic Pi. The touchosc layout is build for my smartphone but should also work on any tablet device where touchosc is running.

The idea behind it: If you want to play with Sonic Pi together with other musicians you can capture incomming sound, loop it and have some basic playback controls. I wanted to have a tool so that I can do the recording and playback control of these captured loops without having to code but rather to accomplish this part with an external controller. The coding is reserved for additional sounds and the manipulation of the recorded sounds.

## TouchOSC-Interface and Features

1. **Go-Button**: Starts the application (runs the library script) and - once the application is running - starts the recording.
2. **Arm track buttons** 1 to 4: the recording will start if you press the Go-button at the next beginning of what you have defined e. g. in the `track_len`-setting (e. g. `set :track1_len, 8`). Any time Sonic Pi actually records you will see a green LED on the left upper corner of the arm-track-button. After that the track will automatically disarmed. The yellow numbers indicate the beat lenght you have configured for you recording tracks.
3. **Metronome**: You need to have an audio feedback, when the recording periods starts. The metronome marks the 1 and the subsequent beats (depending on your track length setting for each individual track); you can set the volume of the metronome and also switch it off completely (orange button below the orange slider)
4. **Playback** volume of track 1 to 4. Set to 0 you can also completely mute a track.
5. A special feedback loop that is recording continuously because the recorded sound is fed back to the recording. There are 6 possible steps: the first steps disables the loop the other steps control the fading of what is recorded. Step 2 means: sound will fade very quickly, step 6 means: the sound will (more or less) stay without fading.

## Components

* **Controller script**: Setup for defaults (such as connection params for OSC, library path, track length etc.); this file has to be loaded into Sonic Pi and evaluated to initialize all variable and make Sonic Pi listen to the touchOSC interface.
* **Library**: This file should reside on your harddrive and will be evaluated each time you press the big red Go-button
* **TouchOSC-layout**: The layout has been made for use on an Android smartphone (layout size 580x320 pixels). Do not edit this file manually but with touchosc editor available at: https://hexler.net/software/touchosc.


## Setup

To set the live looper up you will have to do the following:

* Install the touchosc layout on your smartphone: Easiest way: 1. Save this file as 'index.xml. 2. Create zip-archive containing only this file named e. g. 'live-looper.touchosc'. 3. Open the archive in touchosc editor. 4. Use sync function to transfer to your smartphone (see: https://hexler.net/docs/touchosc-editor-sync
* Configure touchosc app and your smarthone (assuming you have installed touchosc already)
  * Make sure your computer and the smartphone are on the same wifi network.
  * Enter the OSC dialogue in touchosc and set OSC to the IP of your computer.
  * Set the outgoing port to 4559.
  * Set the incomming port to 4000 (you can choose another port but you will then have to adjust `:port` in the controller script).
  * Remember the local IP address of you smartphone which will be display at the bottom of touchosc's OSC dialogue.
* Copy the library script to somewhere on your harddrive 
* Load the controller script into Sonic Pi and do some configuration
  * `:ip` of the computer where you are running the script.
  * `:port`, which is the port of your smarthone (see above)
  * Set the path of the library script via the variable `:libpath`
  * All the rest you can leave as it is for the start:
    * `:metro_vol_master`: master level for metronome 
    * `:my_bpm`: bpm
    * `:playback_master`: master for playback of all tracks
    * `:rec_level`: master for recording level of tracks
    * `:track1_len`: length in beats for track 1
    * `:track2_len`: length in beats for track 2
    * `:track3_len`: length in beats for track 3
    * `:track4_len`: length in beats for track 4
    * `:fbtrack_len`: length in beats for feedback track
* Run the controller script in Sonic Pi and press the Go-button on touchosc.
* And - of course - you will need some sound input to record (accordingly you will have to configure your sound system which I do with Jack under Linux)

## Known Issues


